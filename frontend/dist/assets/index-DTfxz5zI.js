var e=Object.defineProperty;import{r as t,a as r,g as n,R as o}from"./vendor-X31hiD63.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var s={exports:{}},a={},i=t,c=Symbol.for("react.element"),l=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,d=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function p(e,t,r){var n,o={},s=null,a=null;for(n in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(a=t.ref),t)u.call(t,n)&&!f.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:c,type:e,key:s,ref:a,props:o,_owner:d.current}}a.Fragment=l,a.jsx=p,a.jsxs=p,s.exports=a;var y,g=s.exports,m=r;y=m.createRoot,m.hydrateRoot;const h={},x=e=>{let t;const r=new Set,n=(e,n)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},t,o),r.forEach(r=>r(t,e))}},o=()=>t,s={setState:n,getState:o,getInitialState:()=>a,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{"production"!==(h?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},a=t=e(n,o,s);return s};var v={exports:{}},b={},w={exports:{}},j={},S=t;var E="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},N=S.useState,D=S.useEffect,O=S.useLayoutEffect,P=S.useDebugValue;function k(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!E(e,r)}catch(n){return!0}}var L="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=N({inst:{value:r,getSnapshot:t}}),o=n[0].inst,s=n[1];return O(function(){o.value=r,o.getSnapshot=t,k(o)&&s({inst:o})},[e,r,t]),D(function(){return k(o)&&s({inst:o}),e(function(){k(o)&&s({inst:o})})},[e]),P(r),r};j.useSyncExternalStore=void 0!==S.useSyncExternalStore?S.useSyncExternalStore:L,w.exports=j;var I=w.exports,R=t,_=I;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},U=_.useSyncExternalStore,T=R.useRef,M=R.useEffect,V=R.useMemo,A=R.useDebugValue;b.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var s=T(null);if(null===s.current){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=V(function(){function e(e){if(!c){if(c=!0,s=e,e=n(e),void 0!==o&&a.hasValue){var t=a.value;if(o(t,e))return i=t}return i=e}if(t=i,C(s,e))return t;var r=n(e);return void 0!==o&&o(t,r)?(s=e,t):(s=e,i=r)}var s,i,c=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,n,o]);var i=U(e,s[0],s[1]);return M(function(){a.hasValue=!0,a.value=i},[i]),A(i),i},v.exports=b;const z=n(v.exports),F={},{useDebugValue:W}=o,{useSyncExternalStoreWithSelector:q}=z;let B=!1;const $=e=>e;const Q=e=>{"production"!==(F?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?x(e):x)(e):e,r=(e,r)=>function(e,t=$,r){"production"!==(F?"production":void 0)&&r&&!B&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),B=!0);const n=q(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return W(n),n}(t,e,r);return Object.assign(r,t),r};let G;const H=new Uint8Array(16);function J(){if(!G&&(G="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!G))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(H)}const K=[];for(let ge=0;ge<256;++ge)K.push((ge+256).toString(16).slice(1));const Y={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function X(e,t,r){if(Y.randomUUID&&!e)return Y.randomUUID();const n=(e=e||{}).random||(e.rng||J)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]}(n)}const Z="https://seahorse-app-zt3vd.ondigitalocean.app",ee=class e{constructor(){}static getInstance(){return e.instance||(e.instance=new e),e.instance}async syncData(){try{const e=await fetch(`${Z}/api/sync`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to sync data");return await e.json()}catch(e){throw console.error("Error syncing data:",e),e}}async askQuestion(e){try{const t=await fetch(`${Z}/api/ask`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok)throw new Error("Failed to get answer");return await t.json()}catch(t){throw console.error("Error asking question:",t),t}}};var te,re;((t,r,n)=>{r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n})(ee,"symbol"!=typeof(te="instance")?te+"":te,re);const ne=ee.getInstance(),oe=(se=(e,t)=>({messages:[],isLoading:!1,error:null,addMessage:(t,r)=>{const n={id:X(),content:t,role:r,timestamp:new Date};e(e=>({messages:[...e.messages,n]}))},sendMessage:async r=>{const{addMessage:n}=t();e({isLoading:!0,error:null});try{n(r,"user"),n((await ne.askQuestion(r)).answer,"assistant")}catch(o){e({error:"Failed to send message. Please try again."}),console.error("Error sending message:",o)}finally{e({isLoading:!1})}},syncData:async()=>{e({isLoading:!0,error:null});try{await ne.syncData(),e({error:null})}catch(t){e({error:"Failed to sync data. Please try again."}),console.error("Error syncing data:",t)}finally{e({isLoading:!1})}},clearMessages:()=>{e({messages:[],error:null})},setError:t=>{e({error:t})}}))?Q(se):Q;var se;function ae(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=ae(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ie(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=ae(e))&&(n&&(n+=" "),n+=t);return n}const ce=({message:e})=>{const t="user"===e.role;return g.jsx("div",{className:ie("flex w-full mb-4",t?"justify-end":"justify-start"),children:g.jsxs("div",{className:ie("max-w-[80%] rounded-lg px-4 py-2",t?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"),children:[g.jsx("p",{className:"text-sm",children:e.content}),g.jsx("p",{className:"text-xs mt-1 opacity-70",children:new Date(e.timestamp).toLocaleTimeString()})]})})},le=({onSend:e,isLoading:r})=>{const[n,o]=t.useState("");return g.jsxs("form",{onSubmit:t=>{t.preventDefault(),n.trim()&&!r&&(e(n.trim()),o(""))},className:"flex gap-2",children:[g.jsx("input",{type:"text",value:n,onChange:e=>o(e.target.value),placeholder:"Ask about business hours...",className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:r}),g.jsx("button",{type:"submit",disabled:!n.trim()||r,className:"rounded-lg bg-primary-600 px-4 py-2 text-white hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})};async function ue(){const e=await fetch("https://seahorse-app-zt3vd.ondigitalocean.app/api/ping_plain");return await e.text()}const de=()=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),fe=()=>g.jsxs("svg",{className:"animate-spin h-8 w-8",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),pe=()=>{const{messages:e,isLoading:r,error:n,sendMessage:o,syncData:s}=oe(),a=t.useRef(null),[i,c]=t.useState(!0);return t.useEffect(()=>{var e;null==(e=a.current)||e.scrollIntoView({behavior:"smooth"})},[e]),t.useEffect(()=>{(async()=>{await s(),c(!1);try{const e=await ue();console.log("Ping response:",e)}catch(e){console.error("Ping error:",e)}})()},[s]),g.jsxs("div",{className:"flex flex-col h-screen max-w-3xl mx-auto px-4 relative",children:[(i||!i&&r)&&g.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-60 z-50 flex items-center justify-center",children:g.jsx(fe,{})}),g.jsxs("div",{className:"flex justify-between items-center py-4 border-b",children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Google Sheet Chat"}),g.jsxs("button",{onClick:async()=>{console.log("Pinging server..."),await s();try{const e=await ue();console.log("Ping response:",e)}catch(e){console.error("Ping error:",e)}},disabled:r,className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-600 hover:text-gray-900",children:[g.jsx(de,{}),"Refresh Data"]})]}),n&&g.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg mt-4",children:n}),g.jsxs("div",{className:"flex-1 overflow-y-auto py-4",children:[e.map(e=>g.jsx(ce,{message:e},e.id)),g.jsx("div",{ref:a})]}),g.jsx("div",{className:"py-4 border-t",children:g.jsx(le,{onSend:o,isLoading:r})})]})};function ye(){return g.jsx("main",{className:"min-h-screen bg-gray-50",children:g.jsx(pe,{})})}y(document.getElementById("root")).render(g.jsx(t.StrictMode,{children:g.jsx(ye,{})}));
